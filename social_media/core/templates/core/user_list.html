{% extends 'base.html' %}
{% block title %}Users{% endblock %}
{% block content %}
<h2>All Users</h2>

<form method="get" action="{% url 'user_list' %}" style="margin-bottom: 20px;">
    <input 
        type="text" 
        name="q" 
        placeholder="Search users..." 
        value="{{ query }}" 
        style="padding: 5px; width: 200px;"
    >
    <button type="submit">Search</button>
    {% if query %}
        <a href="{% url 'user_list' %}" style="margin-left: 10px;">Clear</a>
    {% endif %}
</form>

{% if users %}
  <ul style="list-style: none; padding: 0;">
    {% for user in users %}
      <li style="margin-bottom: 15px; padding: 10px; border-bottom: 1px solid #ccc;">
        <a href="{% url 'profile' user.username %}">{{ user.username }}</a>

        {% if user.id in following %}
          <form method="post" action="{% url 'toggle_follow' user.username %}" style="display: inline;">
            {% csrf_token %}
            <button type="submit" style="background-color: red; color: white; border: none; padding: 5px 10px; border-radius: 4px;">Unfollow</button>
          </form>
        {% else %}
          <form method="post" action="{% url 'toggle_follow' user.username %}" style="display: inline;">
            {% csrf_token %}
            <button type="submit" style="background-color: green; color: white; border: none; padding: 5px 10px; border-radius: 4px;">Follow</button>
          </form>
        {% endif %}
      </li>
    {% endfor %}
  </ul>
{% else %}
  <p>No other users found.</p>
{% endif %}

{% endblock %}
